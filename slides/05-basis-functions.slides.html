<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>Basis Functions</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">
  <link rel="stylesheet" href="../assets/css/talks.css"/>
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG" type="text/javascript"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    TeX: {
         extensions: ["color.js"]
      }
    });
  </script>
  <script src="../assets/js/figure-animate.js"></script>
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Basis Functions</h1>
  <p class="author" style="text-align:center"><a href="http://inverseprobability.com">Neil D. Lawrence</a></p>
</section>

<section class="slide level2">

<!-- Do not edit this file locally. -->
<!---->
<!-- Do not edit this file locally. -->
<!-- The last names to be defined. Should be defined entirely in terms of macros from above-->
<!--

-->
</section>
<section id="nonlinear-regression" class="slide level2">
<h2>Nonlinear Regression</h2>
<ul>
<li>Problem with Linear Regression—<span class="math inline">\(\mathbf{ x}\)</span> may not be linearly related to <span class="math inline">\(\mathbf{ y}\)</span>.</li>
<li>Potential solution: create a feature space: define <span class="math inline">\(\phi(\mathbf{ x})\)</span> where <span class="math inline">\(\phi(\cdot)\)</span> is a nonlinear function of <span class="math inline">\(\mathbf{ x}\)</span>.</li>
<li>Model for target is a linear combination of these nonlinear functions <span class="math display">\[f(\mathbf{ x}) = \sum_{j=1}^mw_j \phi_j(\mathbf{ x})\]</span></li>
</ul>
</section>
<section id="non-linear-in-the-inputs" class="slide level2">
<h2>Non-linear in the Inputs</h2>
<p><span class="math display">\[
f(\mathbf{ x}) = \mathbf{ w}^\top \mathbf{ x}
\]</span></p>
<!-- SECTION Basis Functions -->
</section>
<section id="basis-functions" class="slide level2">
<h2>Basis Functions</h2>
</section>
<section id="basis-functions-1" class="slide level2">
<h2>Basis Functions</h2>
</section>
<section id="quadratic-basis" class="slide level2">
<h2>Quadratic Basis</h2>
<ul>
<li>Basis functions can be global. E.g. quadratic basis: <span class="math display">\[
\boldsymbol{ \phi}= [1, x, x^2]
\]</span></li>
</ul>
<p><span class="math display">\[
\begin{align*}
\phi_1(x) &amp; = 1, \\
\phi_2(x) &amp; = x, \\
\phi_3(x) &amp; = x^2.
\end{align*}
\]</span></p>
<p><span class="math display">\[
\boldsymbol{ \phi}(x) = \begin{bmatrix} 1\\ x \\ x^2\end{bmatrix}.
\]</span></p>
</section>
<section id="matrix-valued-function" class="slide level2">
<h2>Matrix Valued Function</h2>
<p><span class="math display">\[
\boldsymbol{ \Phi}(\mathbf{ x}) = 
\begin{bmatrix} 1 &amp; x_1 &amp;
x_1^2 \\
1 &amp; x_2 &amp; x_2^2\\
\vdots &amp; \vdots &amp; \vdots \\
1 &amp; x_n &amp; x_n^2
\end{bmatrix}
\]</span></p>
</section>
<section id="functions-derived-from-quadratic-basis" class="slide level2">
<h2>Functions Derived from Quadratic Basis</h2>
<p><span class="math display">\[
f(x) = {\color{cyan}{w_0}}   + {\color{green}{w_1 x}} + {\color{yellow}{w_2 x^2}}
\]</span></p>
<script>
showDivs(0, 'quadratic_basis');
</script>
<p><small></small> <input id="range-quadratic_basis" type="range" min="0" max="2" value="0" onchange="setDivs('quadratic_basis')" oninput="setDivs('quadratic_basis')"> <button onclick="plusDivs(-1, 'quadratic_basis')">❮</button> <button onclick="plusDivs(1, 'quadratic_basis')">❯</button></p>
<div class="quadratic_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/quadratic_basis000.svg" width="80%" style=" ">
</object>
</div>
<div class="quadratic_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/quadratic_basis001.svg" width="80%" style=" ">
</object>
</div>
<div class="quadratic_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/quadratic_basis002.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="quadratic-functions" class="slide level2">
<h2>Quadratic Functions</h2>
<p><span class="math display">\[
f(x) = {\color{cyan}{w_0}}   + {\color{green}{w_1 x}} + {\color{yellow}{w_2 x^2}}
\]</span></p>
<script>
showDivs(0, 'quadratic_function');
</script>
<p><small></small> <input id="range-quadratic_function" type="range" min="0" max="2" value="0" onchange="setDivs('quadratic_function')" oninput="setDivs('quadratic_function')"> <button onclick="plusDivs(-1, 'quadratic_function')">❮</button> <button onclick="plusDivs(1, 'quadratic_function')">❯</button></p>
<div class="quadratic_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/quadratic_function000.svg" width="80%" style=" ">
</object>
</div>
<div class="quadratic_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/quadratic_function001.svg" width="80%" style=" ">
</object>
</div>
<div class="quadratic_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/quadratic_function002.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="different-bases" class="slide level2">
<h2>Different Bases</h2>
<p><span class="math display">\[
\phi_j(x_i) = x_i^j
\]</span></p>
</section>
<section id="polynomial-basis" class="slide level2">
<h2>Polynomial Basis</h2>
<ul>
<li></li>
</ul>
<p><span class="math display">\[
\phi_j(x) = w_j x^j
\]</span></p>
<script>
showDivs(0, 'polynomial_basis');
</script>
<p><small></small> <input id="range-polynomial_basis" type="range" min="0" max="4" value="0" onchange="setDivs('polynomial_basis')" oninput="setDivs('polynomial_basis')"> <button onclick="plusDivs(-1, 'polynomial_basis')">❮</button> <button onclick="plusDivs(1, 'polynomial_basis')">❯</button></p>
<div class="polynomial_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/polynomial_basis000.svg" width="80%" style=" ">
</object>
</div>
<div class="polynomial_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/polynomial_basis001.svg" width="80%" style=" ">
</object>
</div>
<div class="polynomial_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/polynomial_basis002.svg" width="80%" style=" ">
</object>
</div>
<div class="polynomial_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/polynomial_basis003.svg" width="80%" style=" ">
</object>
</div>
<div class="polynomial_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/polynomial_basis004.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="functions-derived-from-polynomial-basis" class="slide level2">
<h2>Functions Derived from Polynomial Basis</h2>
<p><span class="math display">\[
f(x) = {\color{cyan}{w_0}} + {\color{green}{w_1 x}} + {\color{yellow}{w_2 x^2}} + {\color{magenta}{w_3 x^3}} + {\color{red}{w_4 x^4}}
\]</span></p>
<script>
showDivs(0, 'polynomial_function');
</script>
<p><small></small> <input id="range-polynomial_function" type="range" min="0" max="4" value="0" onchange="setDivs('polynomial_function')" oninput="setDivs('polynomial_function')"> <button onclick="plusDivs(-1, 'polynomial_function')">❮</button> <button onclick="plusDivs(1, 'polynomial_function')">❯</button></p>
<div class="polynomial_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/polynomial_function000.svg" width="80%" style=" ">
</object>
</div>
<div class="polynomial_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/polynomial_function001.svg" width="80%" style=" ">
</object>
</div>
<div class="polynomial_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/polynomial_function002.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="exercise-1" class="slide level2">
<h2>Exercise 1</h2>
<p>Try increasing the number of basis functions (thereby increasing the <em>degree</em> of the resulting polynomial). Describe what you see as you increase number of basis up to 10. Is it easy to change the function in intiutive ways?</p>
</section>
<section id="different-basis" class="slide level2">
<h2>Different Basis</h2>
</section>
<section id="radial-basis-functions" class="slide level2">
<h2>Radial Basis Functions</h2>
<ul>
<li>Basis functions can be local e.g. radial (or Gaussian) basis <span class="math display">\[
\phi_j(x) = \exp\left(-\frac{(x-\mu_j)^2}{\ell^2}\right)
\]</span></li>
</ul>
<script>
showDivs(0, 'radial_basis');
</script>
<p><small></small> <input id="range-radial_basis" type="range" min="0" max="2" value="0" onchange="setDivs('radial_basis')" oninput="setDivs('radial_basis')"> <button onclick="plusDivs(-1, 'radial_basis')">❮</button> <button onclick="plusDivs(1, 'radial_basis')">❯</button></p>
<div class="radial_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/radial_basis000.svg" width="80%" style=" ">
</object>
</div>
<div class="radial_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/radial_basis001.svg" width="80%" style=" ">
</object>
</div>
<div class="radial_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/radial_basis002.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="functions-derived-from-radial-basis" class="slide level2">
<h2>Functions Derived from Radial Basis</h2>
<p><span class="math display">\[
f(x) = \color{cyan}{w_1 e^{-2(x+1)^2}}  + \color{green}{w_2e^{-2x^2}} + \color{yellow}{w_3 e^{-2(x-1)^2}}
\]</span></p>
<script>
showDivs(0, 'radial_function');
</script>
<p><small></small> <input id="range-radial_function" type="range" min="0" max="2" value="0" onchange="setDivs('radial_function')" oninput="setDivs('radial_function')"> <button onclick="plusDivs(-1, 'radial_function')">❮</button> <button onclick="plusDivs(1, 'radial_function')">❯</button></p>
<div class="radial_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/radial_function000.svg" width="80%" style=" ">
</object>
</div>
<div class="radial_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/radial_function001.svg" width="80%" style=" ">
</object>
</div>
<div class="radial_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/radial_function002.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="rectified-linear-units" class="slide level2">
<h2>Rectified Linear Units</h2>
<ul>
<li></li>
</ul>
<p><span class="math display">\[
\phi_j(x) = H(v_j x+ v_0)
\]</span></p>
<script>
showDivs(0, 'relu_basis');
</script>
<p><small></small> <input id="range-relu_basis" type="range" min="0" max="4" value="0" onchange="setDivs('relu_basis')" oninput="setDivs('relu_basis')"> <button onclick="plusDivs(-1, 'relu_basis')">❮</button> <button onclick="plusDivs(1, 'relu_basis')">❯</button></p>
<div class="relu_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/relu_basis000.svg" width="80%" style=" ">
</object>
</div>
<div class="relu_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/relu_basis001.svg" width="80%" style=" ">
</object>
</div>
<div class="relu_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/relu_basis002.svg" width="80%" style=" ">
</object>
</div>
<div class="relu_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/relu_basis003.svg" width="80%" style=" ">
</object>
</div>
<div class="relu_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/relu_basis004.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="functions-derived-from-relu-basis" class="slide level2">
<h2>Functions Derived from Relu Basis</h2>
<p><span class="math display">\[
f(x) = \color{cyan}{w_0}   + \color{green}{w_1 xH(x+1.0) } + \color{yellow}{w_2 xH(x+0.33) } + \color{magenta}{w_3 xH(x-0.33)} +  \color{red}{w_4 xH(x-1.0)}
\]</span></p>
<script>
showDivs(0, 'relu_function');
</script>
<p><small></small> <input id="range-relu_function" type="range" min="0" max="4" value="0" onchange="setDivs('relu_function')" oninput="setDivs('relu_function')"> <button onclick="plusDivs(-1, 'relu_function')">❮</button> <button onclick="plusDivs(1, 'relu_function')">❯</button></p>
<div class="relu_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/relu_function000.svg" width="80%" style=" ">
</object>
</div>
<div class="relu_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/relu_function001.svg" width="80%" style=" ">
</object>
</div>
<div class="relu_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/relu_function002.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="hyperbolic-tangent-basis" class="slide level2">
<h2>Hyperbolic Tangent Basis</h2>
<ul>
<li></li>
</ul>
<p><span class="math display">\[
\phi_j(x) = \tanh(v_j x+ v_0)
\]</span></p>
<script>
showDivs(0, 'tanh_basis');
</script>
<p><small></small> <input id="range-tanh_basis" type="range" min="0" max="4" value="0" onchange="setDivs('tanh_basis')" oninput="setDivs('tanh_basis')"> <button onclick="plusDivs(-1, 'tanh_basis')">❮</button> <button onclick="plusDivs(1, 'tanh_basis')">❯</button></p>
<div class="tanh_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/tanh_basis000.svg" width="80%" style=" ">
</object>
</div>
<div class="tanh_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/tanh_basis001.svg" width="80%" style=" ">
</object>
</div>
<div class="tanh_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/tanh_basis002.svg" width="80%" style=" ">
</object>
</div>
<div class="tanh_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/tanh_basis003.svg" width="80%" style=" ">
</object>
</div>
<div class="tanh_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/tanh_basis004.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="functions-derived-from-tanh-basis" class="slide level2">
<h2>Functions Derived from Tanh Basis</h2>
<p><span class="math display">\[
f(x) = {\color{cyan}{w_0}}   + {\color{green}{w_1 \text{tanh}\left(x+1\right)}}  + {\color{yellow}{w_2 \text{tanh}\left(x+0.33\right)}}  + {\color{magenta}{w_3 \text{tanh}\left(x-0.33\right)}} + {\color{red}{w_4 \text{tanh}\left(x-1\right)}}
\]</span></p>
<script>
showDivs(0, 'tanh_function');
</script>
<p><small></small> <input id="range-tanh_function" type="range" min="0" max="4" value="0" onchange="setDivs('tanh_function')" oninput="setDivs('tanh_function')"> <button onclick="plusDivs(-1, 'tanh_function')">❮</button> <button onclick="plusDivs(1, 'tanh_function')">❯</button></p>
<div class="tanh_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/tanh_function000.svg" width="80%" style=" ">
</object>
</div>
<div class="tanh_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/tanh_function001.svg" width="80%" style=" ">
</object>
</div>
<div class="tanh_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/tanh_function002.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="fourier-basis" class="slide level2">
<h2>Fourier Basis</h2>
<ul>
<li></li>
</ul>
<p><span class="math display">\[
f(x) = w_0  + w_1 \sin(x) + w_2 \cos(x) + w_3 \sin(2x) + w_4 \cos(2x)
\]</span></p>
<script>
showDivs(0, 'fourier_basis');
</script>
<p><small></small> <input id="range-fourier_basis" type="range" min="0" max="4" value="0" onchange="setDivs('fourier_basis')" oninput="setDivs('fourier_basis')"> <button onclick="plusDivs(-1, 'fourier_basis')">❮</button> <button onclick="plusDivs(1, 'fourier_basis')">❯</button></p>
<div class="fourier_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/fourier_basis000.svg" width="80%" style=" ">
</object>
</div>
<div class="fourier_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/fourier_basis001.svg" width="80%" style=" ">
</object>
</div>
<div class="fourier_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/fourier_basis002.svg" width="80%" style=" ">
</object>
</div>
<div class="fourier_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/fourier_basis003.svg" width="80%" style=" ">
</object>
</div>
<div class="fourier_basis" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/fourier_basis004.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="functions-derived-from-fourier-basis" class="slide level2">
<h2>Functions Derived from Fourier Basis</h2>
<p><span class="math display">\[
f(x) = {\color{cyan}{w_0}}  + {\color{green}{w_1 \sin(x)}} + {\color{yellow}{w_2 \cos(x)}} + {\color{magenta}{w_3 \sin(2x)}} + {\color{red}{w_4 \cos(2x)}}
\]</span></p>
<script>
showDivs(0, 'fourier_function');
</script>
<p><small></small> <input id="range-fourier_function" type="range" min="0" max="4" value="0" onchange="setDivs('fourier_function')" oninput="setDivs('fourier_function')"> <button onclick="plusDivs(-1, 'fourier_function')">❮</button> <button onclick="plusDivs(1, 'fourier_function')">❯</button></p>
<div class="fourier_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/fourier_function000.svg" width="80%" style=" ">
</object>
</div>
<div class="fourier_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/fourier_function001.svg" width="80%" style=" ">
</object>
</div>
<div class="fourier_function" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/fourier_function002.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="fitting-to-data" class="slide level2">
<h2>Fitting to Data</h2>
<p>Now we are going to consider how these basis functions can be adjusted to fit to a particular data set. We will return to the olympic marathon data from last time. First we will scale the output of the data to be zero mean and variance 1.</p>
</section>
<section id="olympic-marathon-data" class="slide level2">
<h2>Olympic Marathon Data</h2>
<table>
<tr>
<td width="70%">
<ul>
<li>Gold medal times for Olympic Marathon since 1896.</li>
<li>Marathons before 1924 didn’t have a standardised distance.</li>
<li>Present results using pace per km.</li>
<li>In 1904 Marathon was badly organised leading to very slow times.</li>
</ul>
</td>
<td width="30%">
<div class="centered centered" style="">
<img class="" src="../slides/diagrams/Stephen_Kiprotich.jpg" width="100%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
<small>Image from Wikimedia Commons <a href="http://bit.ly/16kMKHQ" class="uri">http://bit.ly/16kMKHQ</a></small>
</td>
</tr>
</table>
</section>
<section id="olympic-marathon-data-1" class="slide level2">
<h2>Olympic Marathon Data</h2>
<div class="figure">
<div id="olympic-marathon-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/datasets/olympic-marathon.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
Olympic marathon pace times since 1892.
</aside>
</section>
<section id="exercise-0" class="slide level2">
<h2>Exercise 0</h2>
<p>Now we are going to redefine our polynomial basis. Have a careful look at the operations we perform on <code>x</code> to create <code>z</code>. We use <code>z</code> in the polynomial computation. What are we doing to the inputs? Why do you think we are changing <code>x</code> in this manner?</p>
</section>
<section id="exercise-2" class="slide level2">
<h2>Exercise 2</h2>
<p>Use the tool provided above to try and find the best fit you can to the data. Explore the parameter space and give the weight values you used for the</p>
<ol type="a">
<li>polynomial basis</li>
<li>Radial basis</li>
<li>Fourier basis</li>
</ol>
<p>Write your answers in the code box below creating a new vector of parameters (in the correct order!) for each basis.</p>
</section>
<section id="basis-function-models" class="slide level2">
<h2>Basis Function Models</h2>
<ul>
<li>The <em>prediction function</em> is now defined as <span class="math display">\[
f(\mathbf{ x}_i) = \sum_{j=1}^mw_j \phi_{i, j}
\]</span></li>
</ul>
</section>
<section id="vector-notation" class="slide level2">
<h2>Vector Notation</h2>
<ul>
<li>Write in vector notation, <span class="math display">\[
f(\mathbf{ x}_i) = \mathbf{ w}^\top \boldsymbol{ \phi}_i
\]</span></li>
</ul>
</section>
<section id="log-likelihood-for-basis-function-model" class="slide level2">
<h2>Log Likelihood for Basis Function Model</h2>
<ul>
<li>The likelihood of a single data point is <span class="math display">\[
p\left(y_i|x_i\right)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp\left(-\frac{\left(y_i-\mathbf{ w}^{\top}\boldsymbol{ \phi}_i\right)^{2}}{2\sigma^2}\right).
\]</span></li>
</ul>
</section>
<section id="log-likelihood-for-basis-function-model-1" class="slide level2">
<h2>Log Likelihood for Basis Function Model</h2>
<ul>
<li>Leading to a log likelihood for the data set of <span class="math display">\[
L(\mathbf{ w},\sigma^2)= -\frac{n}{2}\log \sigma^2-\frac{n}{2}\log 2\pi -\frac{\sum_{i=1}^{n}\left(y_i-\mathbf{ w}^{\top}\boldsymbol{ \phi}_i\right)^{2}}{2\sigma^2}.
\]</span></li>
</ul>
</section>
<section id="objective-function" class="slide level2">
<h2>Objective Function</h2>
<ul>
<li>And a corresponding <em>objective function</em> of the form <span class="math display">\[
E(\mathbf{ w},\sigma^2)= \frac{n}{2}\log\sigma^2 + \frac{\sum_{i=1}^{n}\left(y_i-\mathbf{ w}^{\top}\boldsymbol{ \phi}_i\right)^{2}}{2\sigma^2}.
\]</span></li>
</ul>
</section>
<section id="expand-the-brackets" class="slide level2">
<h2>Expand the Brackets</h2>
<p><span class="math display">\[
\begin{align}
  E(\mathbf{ w},\sigma^2) = &amp;\frac{n}{2}\log \sigma^2 + \frac{1}{2\sigma^2}\sum_{i=1}^{n}y_i^{2}-\frac{1}{\sigma^2}\sum_{i=1}^{n}y_i\mathbf{ w}^{\top}\boldsymbol{ \phi}_i\\ &amp;+\frac{1}{2\sigma^2}\sum_{i=1}^{n}\mathbf{ w}^{\top}\boldsymbol{ \phi}_i\boldsymbol{ \phi}_i^{\top}\mathbf{ w}+\text{const}.
\end{align}
\]</span></p>
</section>
<section id="expand-the-brackets-1" class="slide level2">
<h2>Expand the Brackets</h2>
<p><span class="math display">\[\begin{align} E(\mathbf{ w}, \sigma^2) = &amp; \frac{n}{2}\log \sigma^2 + \frac{1}{2\sigma^2}\sum_{i=1}^{n}y_i^{2}-\frac{1}{\sigma^2} \mathbf{ w}^\top\sum_{i=1}^{n}\boldsymbol{ \phi}_i y_i\\ &amp; +\frac{1}{2\sigma^2}\mathbf{ w}^{\top}\left[\sum_{i=1}^{n}\boldsymbol{ \phi}_i\boldsymbol{ \phi}_i^{\top}\right]\mathbf{ w}+\text{const}.\end{align}\]</span></p>
</section>
<section id="design-matrices" class="slide level2">
<h2>Design Matrices</h2>
<ul>
<li>Design matrix notation <span class="math display">\[
\boldsymbol{ \Phi}= \begin{bmatrix} \mathbf{1} &amp; \mathbf{ x}&amp; \mathbf{ x}^2\end{bmatrix}
\]</span> so that <span class="math display">\[
\boldsymbol{ \Phi}\in \Re^{n\times p}.
\]</span></li>
</ul>
</section>
<section id="multivariate-derivatives-reminder" class="slide level2">
<h2>Multivariate Derivatives Reminder</h2>
<ul>
<li>We will need some multivariate calculus. <span class="math display">\[\frac{\text{d}\mathbf{a}^{\top}\mathbf{ w}}{\text{d}\mathbf{ w}}=\mathbf{a}\]</span> and <span class="math display">\[\frac{\text{d}\mathbf{ w}^{\top}\mathbf{A}\mathbf{ w}}{\text{d}\mathbf{ w}}=\left(\mathbf{A}+\mathbf{A}^{\top}\right)\mathbf{ w}\]</span> or if <span class="math inline">\(\mathbf{A}\)</span> is symmetric (<em>i.e.</em> <span class="math inline">\(\mathbf{A}=\mathbf{A}^{\top}\)</span>) <span class="math display">\[\frac{\text{d}\mathbf{ w}^{\top}\mathbf{A}\mathbf{ w}}{\text{d}\mathbf{ w}}=2\mathbf{A}\mathbf{ w}.\]</span></li>
</ul>
</section>
<section id="differentiate" class="slide level2">
<h2>Differentiate</h2>
<p>Differentiating with respect to the vector <span class="math inline">\(\mathbf{ w}\)</span> we obtain <span class="math display">\[\frac{\text{d} E\left(\mathbf{ w},\sigma^2 \right)}{\text{d}\mathbf{ w}}=-\frac{1}{\sigma^2} \sum_{i=1}^{n}\boldsymbol{ \phi}_iy_i+\frac{1}{\sigma^2} \left[\sum_{i=1}^{n}\boldsymbol{ \phi}_i\boldsymbol{ \phi}_i^{\top}\right]\mathbf{ w}\]</span> Leading to <span class="math display">\[\mathbf{ w}^{*}=\left[\sum_{i=1}^{n}\boldsymbol{ \phi}_i\boldsymbol{ \phi}_i^{\top}\right]^{-1}\sum_{i=1}^{n}\boldsymbol{ \phi}_iy_i,\]</span></p>
</section>
<section id="matrix-notation" class="slide level2">
<h2>Matrix Notation</h2>
<p>Rewrite in matrix notation: <span class="math display">\[
\sum_{i=1}^{n}\boldsymbol{ \phi}_i\boldsymbol{ \phi}_i^\top = \boldsymbol{ \Phi}^\top \boldsymbol{ \Phi}\]</span> <span class="math display">\[\sum _{i=1}^{n}\boldsymbol{ \phi}_iy_i = \boldsymbol{ \Phi}^\top \mathbf{ y}
\]</span></p>
</section>
<section id="update-equations" class="slide level2">
<h2>Update Equations</h2>
<ul>
<li>Update for <span class="math inline">\(\mathbf{ w}^{*}\)</span> <span class="math display">\[
\mathbf{ w}^{*} = \left(\boldsymbol{ \Phi}^\top \boldsymbol{ \Phi}\right)^{-1} \boldsymbol{ \Phi}^\top \mathbf{ y}
\]</span></li>
<li>The equation for <span class="math inline">\(\left.\sigma^2\right.^{*}\)</span> may also be found <span class="math display">\[
\left.\sigma^2\right.^{{*}}=\frac{\sum_{i=1}^{n}\left(y_i-\left.\mathbf{ w}^{*}\right.^{\top}\boldsymbol{ \phi}_i\right)^{2}}{n}.
\]</span></li>
</ul>
</section>
<section id="avoid-direct-inverse" class="slide level2">
<h2>Avoid Direct Inverse</h2>
<ul>
<li>E.g. Solve for <span class="math inline">\(\mathbf{ w}\)</span> <span class="math display">\[
\left(\boldsymbol{ \Phi}^\top \boldsymbol{ \Phi}\right)\mathbf{ w}= \boldsymbol{ \Phi}^\top \mathbf{ y}
\]</span></li>
<li>See <code>np.linalg.solve</code></li>
<li>In practice use <span class="math inline">\(\mathbf{Q}\mathbf{R}\)</span> decomposition (see lab class notes).</li>
</ul>
</section>
<section id="polynomial-fits-to-olympic-data" class="slide level2">
<h2>Polynomial Fits to Olympic Data</h2>
<script>
showDivs(1, 'olympic_LM_polynomial_number');
</script>
<p><small></small> <input id="range-olympic_LM_polynomial_number" type="range" min="1" max="26" value="1" onchange="setDivs('olympic_LM_polynomial_number')" oninput="setDivs('olympic_LM_polynomial_number')"> <button onclick="plusDivs(-1, 'olympic_LM_polynomial_number')">❮</button> <button onclick="plusDivs(1, 'olympic_LM_polynomial_number')">❯</button></p>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number001.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number002.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number003.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number004.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number005.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number006.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number007.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number008.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number009.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number010.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number011.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number012.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number013.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number014.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number015.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number016.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number017.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number018.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number019.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number020.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number021.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number022.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number023.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number024.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number025.svg" width="80%" style=" ">
</object>
</div>
<div class="olympic_LM_polynomial_number" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/olympic_LM_polynomial_number026.svg" width="80%" style=" ">
</object>
</div>
</section>
<section id="non-linear-but-linear-in-the-parameters" class="slide level2">
<h2>Non-linear but Linear in the Parameters</h2>
<ul>
<li>Model is non-linear, but linear in parameters <span class="math display">\[
f(\mathbf{ x}) = \mathbf{ w}^\top \boldsymbol{ \phi}(\mathbf{ x})
\]</span></li>
<li><span class="math inline">\(\mathbf{ x}\)</span> is inside the non-linearity, but <span class="math inline">\(\mathbf{ w}\)</span> is outside. <span class="math display">\[
f(\mathbf{ x}) = \mathbf{ w}^\top \boldsymbol{ \phi}(\mathbf{ x};
\boldsymbol{\theta}),
\]</span></li>
</ul>
</section>
<section id="exercise-0-1" class="slide level2">
<h2>Exercise 0</h2>
<p>For the following prediction functions state whether the model is linear in the inputs, the parameters or both.</p>
<ol type="a">
<li><p><span class="math inline">\(f(x) = w_1x_1 + w_2\)</span></p></li>
<li><p><span class="math inline">\(f(x) = w_1\exp(x_1) + w_2x_2 + w_3\)</span></p></li>
<li><p><span class="math inline">\(f(x) = \log(x_1^{w_1}) + w_2x_2^2 + w_3\)</span></p></li>
<li><p><span class="math inline">\(f(x) = \exp(-\sum_i(x_i - w_i)^2)\)</span></p></li>
<li><p><span class="math inline">\(f(x) = \exp(-\mathbf{ w}^\top \mathbf{ x})\)</span></p></li>
</ol>
</section>
<section id="exercise-3" class="slide level2">
<h2>Exercise 3</h2>
<p>Choose one of the basis functions you have explored above. Compute the design matrix on the covariates (or input data), <code>x</code>. Use the design matrix and the response variable <code>y</code> to solve the following linear system for the model parameters <code>w</code>. <span class="math display">\[
\boldsymbol{ \phi}^\top\boldsymbol{ \phi}\mathbf{ w}= \boldsymbol{ \phi}^\top \mathbf{ y}
\]</span> Compute the corresponding error on the training data. How does it compare to the error you were able to achieve fitting the basis above? Plot the form of your prediction function from the least squares estimate alongside the form of you prediction function you fitted by hand.</p>
</section>
<section id="further-reading" class="slide level2 scrollable">
<h2 class="scrollable">Further Reading</h2>
<ul>
<li><p>Section 1.4 of <span class="citation" data-cites="Rogers:book11">Rogers and Girolami (2011)</span></p></li>
<li><p>Chapter 1, pg 1-6 of <span class="citation" data-cites="Bishop:book06">Bishop (2006)</span></p></li>
<li><p>Chapter 3, Section 3.1 up to pg 143 of <span class="citation" data-cites="Bishop:book06">Bishop (2006)</span></p></li>
</ul>
</section>
<section id="lecture-on-basis-functions-from-gprs-uganda" class="slide level2">
<h2>Lecture on Basis Functions from GPRS Uganda</h2>
<div class="figure">
<div id="basis-functions-gprs-uganda-figure" class="figure-frame">
<iframe width="600" height="450" src="https://www.youtube.com/embed/PoNbOnUnOao?start=" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
</div>
<aside class="notes">
Lecture on Basis functions from GPRS in Uganda in 2013.
</aside>
</section>
<section id="use-of-qr-decomposition-for-numerical-stability" class="slide level2">
<h2>Use of QR Decomposition for Numerical Stability</h2>
<p><em>TODO</em> example with polynomials.</p>
</section>
<section id="thanks" class="slide level2 scrollable">
<h2 class="scrollable">Thanks!</h2>
<ul>
<li><p>twitter: <a href="https://twitter.com/lawrennd">@lawrennd</a></p></li>
<li><p>podcast: <a href="http://thetalkingmachines.com">The Talking Machines</a></p></li>
<li><p>newspaper: <a href="http://www.theguardian.com/profile/neil-lawrence">Guardian Profile Page</a></p></li>
<li><p>blog posts:</p>
<p><a href="http://inverseprobability.com/2014/07/01/open-data-science">Open Data Science</a></p></li>
</ul>
</section>
<section id="references" class="slide level2 unnumbered scrollable">
<h2 class="unnumbered scrollable">References</h2>
<div id="refs" class="references hanging-indent" role="doc-bibliography">
<div id="ref-Bishop:book06">
<p>Bishop, C.M., 2006. Pattern recognition and machine learning. springer.</p>
</div>
<div id="ref-Rogers:book11">
<p>Rogers, S., Girolami, M., 2011. A first course in machine learning. CRC Press.</p>
</div>
</div>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Push each slide change to the browser history
        history: true,
        // Transition style
        transition: 'None', // none/fade/slide/convex/concave/zoom
        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'reveal.js/plugin/math/math.js', async: true },
          { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
